{"version":3,"file":"plugin.cjs.js","sources":["esm/index.js","esm/web.js"],"sourcesContent":["import { registerPlugin } from '@capacitor/core';\r\nconst SignInWithApple = registerPlugin('SignInWithApple', {\r\n    web: () => import('./web').then(m => new m.SignInWithAppleWeb()),\r\n});\r\nexport * from './definitions';\r\nexport { SignInWithApple };\r\n//# sourceMappingURL=index.js.map","import { WebPlugin } from '@capacitor/core';\r\nimport * as $script from 'scriptjs';\r\nexport class SignInWithAppleWeb extends WebPlugin {\r\n    constructor() {\r\n        super({\r\n            name: 'SignInWithApple',\r\n            platforms: ['web'],\r\n        });\r\n        this.appleScriptUrl = 'https://appleid.cdn-apple.com/appleauth/static/jsapi/appleid/1/en_US/appleid.auth.js';\r\n        this.isAppleScriptLoaded = false;\r\n    }\r\n    async authorize(options) {\r\n        return new Promise((resolve, reject) => {\r\n            if (options) {\r\n                this.loadSignInWithAppleJS().then(loaded => {\r\n                    var _a, _b, _c;\r\n                    this.isAppleScriptLoaded = loaded;\r\n                    if (this.isAppleScriptLoaded) {\r\n                        AppleID.auth.init({\r\n                            clientId: options.clientId,\r\n                            redirectURI: options.redirectURI,\r\n                            scope: (_a = options.scopes) !== null && _a !== void 0 ? _a : undefined,\r\n                            state: (_b = options.state) !== null && _b !== void 0 ? _b : undefined,\r\n                            nonce: (_c = options.nonce) !== null && _c !== void 0 ? _c : undefined,\r\n                            usePopup: true,\r\n                        });\r\n                        AppleID.auth\r\n                            .signIn()\r\n                            .then((res) => {\r\n                            var _a, _b, _c, _d, _e;\r\n                            const response = {\r\n                                response: {\r\n                                    user: null,\r\n                                    email: (_a = res.user) === null || _a === void 0 ? void 0 : _a.email,\r\n                                    givenName: (_c = (_b = res.user) === null || _b === void 0 ? void 0 : _b.name) === null || _c === void 0 ? void 0 : _c.firstName,\r\n                                    familyName: (_e = (_d = res.user) === null || _d === void 0 ? void 0 : _d.name) === null || _e === void 0 ? void 0 : _e.lastName,\r\n                                    identityToken: res.authorization.id_token,\r\n                                    authorizationCode: res.authorization.code,\r\n                                },\r\n                            };\r\n                            resolve(response);\r\n                        })\r\n                            .catch((err) => {\r\n                            reject(err);\r\n                        });\r\n                    }\r\n                    else {\r\n                        reject('Unable to load Sign in with Apple JS framework.');\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                reject('No options were provided.');\r\n            }\r\n        });\r\n    }\r\n    loadSignInWithAppleJS() {\r\n        return new Promise(resolve => {\r\n            if (!this.isAppleScriptLoaded) {\r\n                if (typeof window !== undefined) {\r\n                    $script.get(this.appleScriptUrl, () => resolve(true));\r\n                }\r\n                else {\r\n                    resolve(false);\r\n                }\r\n            }\r\n            else {\r\n                resolve(true);\r\n            }\r\n        });\r\n    }\r\n}\r\n//# sourceMappingURL=web.js.map"],"names":["registerPlugin","WebPlugin","$script"],"mappings":"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"}